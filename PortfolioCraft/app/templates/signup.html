{% extends "base.html" %}

{% block content %}

<div id="mainContainer" class="relative min-h-screen font-sans">
  <div class="p-4">
    <a href="{{ url_for('main.home') }}"
      class="inline-flex items-center px-4 py-2 rounded-xl shadow-md text-white bg-[#687FE5] hover:bg-[#566AD1] transition">
      ← Back
    </a>
  </div>
  <div class="min-h-screen flex items-center justify-center p-4">
    <div
      class="auth-container max-w-4xl w-full bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row">

      <div class="w-full md:w-1/2 p-8 md:p-10">
        <div class="text-center mb-8">
          <h2 class="text-3xl font-bold text-gray-800">Create Your Account</h2>
          <p class="text-gray-600 mt-2">Start building your professional portfolio today</p>
        </div>

        <form method="POST" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="full_name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
              <input type="text" id="full_name" name="full_name"
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-lavender transition"
                placeholder="John Doe" required>
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
              <input type="email" id="email" name="email"
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-lavender transition"
                placeholder="you@example.com" required>
            </div>
          </div>

          <div>
            <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input type="password" id="password" name="password"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-lavender transition"
              placeholder="••••••••" required oninput="checkPasswordStrength(this.value)">

            <div class="flex mt-2 space-x-1">
              <div id="strength-1" class="h-1 w-full bg-gray-200 rounded-full"></div>
              <div id="strength-2" class="h-1 w-full bg-gray-200 rounded-full"></div>
              <div id="strength-3" class="h-1 w-full bg-gray-200 rounded-full"></div>
              <div id="strength-4" class="h-1 w-full bg-gray-200 rounded-full"></div>
            </div>
            <p id="password-hint" class="text-xs text-gray-500 mt-1">Use at least 8 characters with a mix of letters,
              numbers & symbols</p>
          </div>

          <div class="flex items-start">
            <input id="terms" name="terms" type="checkbox"
              class="h-4 w-4 text-royalblue focus:ring-royalblue border-gray-300 rounded mt-1">
            <label for="terms" class="ml-2 block text-sm text-gray-700">
              I agree to the <a href="#" class="text-royalblue hover:underline">Terms of Service</a> and <a href="#"
                class="text-royalblue hover:underline">Privacy Policy</a>
            </label>
          </div>

          <button type="submit"
            class="btn-primary w-full py-3 px-4 rounded-lg text-white font-medium text-center mt-6">Create
            Account</button>

          <div class="or-divider text-sm">OR</div>

          <div class="grid grid-cols-2 gap-4">
            <button type="button"
              class="flex items-center justify-center py-2 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
              <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12.545 10.239v3.821h5.445c-0.712 2.315-2.647 3.972-5.445 3.972-3.332 0-6.033-2.701-6.033-6.032s2.701-6.032 6.033-6.032c1.498 0 2.866 0.549 3.921 1.453l2.814-2.814c-1.786-1.667-4.167-2.698-6.735-2.698-5.522 0-10 4.477-10 10s4.478 10 10 10c8.396 0 10-7.496 10-10 0-0.67-0.065-1.35-0.195-2.001h-9.805z" />
              </svg>
              Google
            </button>
            <button type="button"
              class="flex items-center justify-center py-2 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
              <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
              </svg>
              LinkedIn
            </button>
          </div>

          <div class="text-center text-sm text-gray-600 mt-6">
            Already have an account? <a href="{{ url_for('main.login') }}"
              class="text-royalblue font-medium hover:underline">Sign in</a>
          </div>
        </form>
      </div>


      <div class="hidden md:block w-1/2 bg-gradient-to-br from-peach to-lavender relative overflow-hidden">
        <div class="absolute inset-0 flex items-center justify-center p-10">
          <div class="text-center">
            <div class="relative inline-block">
              <svg class="w-40 h-40 mx-auto text-royalblue opacity-90 animate-bounce-x" viewBox="0 0 24 24" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
                  stroke="currentColor" stroke-width="2" />
                <path d="M8 14C8 14 9.5 16 12 16C14.5 16 16 14 16 14M9 10H9.01M15 10H15.01" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="absolute -bottom-6 -right-6 w-16 h-16 bg-pink rounded-full opacity-70"></div>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mt-6">Your Professional Journey Starts Here</h3>
            <p class="text-gray-700 mt-2">Create a portfolio that gets you noticed</p>

            <div class="mt-8 text-left max-w-xs mx-auto space-y-4">
              <div class="flex items-start">
                <svg class="w-5 h-5 text-royalblue mt-0.5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="text-gray-700">AI-generated professional summaries</span>
              </div>
              <div class="flex items-start">
                <svg class="w-5 h-5 text-royalblue mt-0.5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="text-gray-700">Beautiful, customizable templates</span>
              </div>
              <div class="flex items-start">
                <svg class="w-5 h-5 text-royalblue mt-0.5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="text-gray-700">One-click publishing</span>
              </div>
            </div>
          </div>
        </div>


        <div
          class="absolute top-0 right-0 w-32 h-32 bg-white rounded-full opacity-10 transform translate-x-16 -translate-y-16">
        </div>
        <div
          class="absolute bottom-0 left-0 w-48 h-48 bg-white rounded-full opacity-10 transform -translate-x-16 translate-y-16">
        </div>
      </div>
    </div>
  </div>

  <script>

    function checkPasswordStrength(password) {
      const strengthBars = [
        document.getElementById('strength-1'),
        document.getElementById('strength-2'),
        document.getElementById('strength-3'),
        document.getElementById('strength-4')
      ];

      const hint = document.getElementById('password-hint');
      let strength = 0;


      strengthBars.forEach(bar => {
        if (!bar) return;
        bar.classList.remove('bg-red-500', 'bg-yellow-400', 'bg-green-400', 'bg-green-500', 'bg-gray-200');
        bar.classList.add('bg-gray-200');
      });

      if (!password || password.length === 0) {
        hint.textContent = "Use at least 8 characters with a mix of letters, numbers & symbols";
        hint.className = "text-xs text-gray-500 mt-1";
        return;
      }


      if (password.length > 7) strength++;


      if (/\d/.test(password)) strength++;


      if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength++;


      if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;


      for (let i = 0; i < strength; i++) {
        const bar = strengthBars[i];
        if (!bar) continue;
        bar.classList.remove('bg-gray-200');
        if (i < 2) {
          bar.classList.add('bg-red-500');
        } else if (i === 2) {
          bar.classList.add('bg-yellow-400');
        } else {
          bar.classList.add('bg-green-500');
        }
      }


      if (strength === 0) {
        hint.textContent = "Very weak - try adding more characters";
        hint.className = "text-xs text-red-500 mt-1";
      } else if (strength === 1) {
        hint.textContent = "Weak - try adding numbers or symbols";
        hint.className = "text-xs text-red-500 mt-1";
      } else if (strength === 2) {
        hint.textContent = "Moderate - could be stronger with mixed case or symbols";
        hint.className = "text-xs text-yellow-500 mt-1";
      } else if (strength === 3) {
        hint.textContent = "Strong - good job!";
        hint.className = "text-xs text-green-500 mt-1";
      } else {
        hint.textContent = "Very strong - excellent password!";
        hint.className = "text-xs text-green-500 mt-1";
      }
    }


    function ensureErrorElement(fieldEl, id, defaultClass = "text-xs text-red-500 mt-1") {
      let err = document.getElementById(id);
      if (!err) {
        err = document.createElement('p');
        err.id = id;
        err.className = defaultClass + " hidden";
        fieldEl.insertAdjacentElement('afterend', err);
      }
      return err;
    }

    function showError(fieldEl, id, message) {
      const err = ensureErrorElement(fieldEl, id);
      err.textContent = message;
      err.classList.remove('hidden');
      fieldEl.classList.add('border-red-400', 'animate-pulse');

      setTimeout(() => fieldEl.classList.remove('animate-pulse'), 800);
    }

    function hideError(fieldEl, id) {
      const err = document.getElementById(id);
      if (err) err.classList.add('hidden');
      fieldEl.classList.remove('border-red-400');
    }


    (function setupValidation() {
      const form = document.querySelector('form');
      if (!form) return;

      const nameField = document.getElementById('full_name');
      const emailField = document.getElementById('email');
      const passwordField = document.getElementById('password');
      const terms = document.getElementById('terms');


      if (nameField) {
        nameField.addEventListener('input', () => {
          hideError(nameField, 'name-error');
        });
      }
      if (emailField) {
        emailField.addEventListener('input', () => {
          hideError(emailField, 'email-error');
        });
      }
      if (passwordField) {
        passwordField.addEventListener('input', (e) => {

          checkPasswordStrength(e.target.value);
          hideError(passwordField, 'password-error');
        });
      }
      if (terms) {
        terms.addEventListener('change', () => {
          terms.classList.remove('animate-pulse', 'border-red-300');
        });
      }


      form.addEventListener('submit', function (e) {
        let valid = true;


        if (nameField) {
          const nameVal = nameField.value.trim();
          const nameRegex = /^[A-Za-z ]{3,}$/;
          if (!nameRegex.test(nameVal)) {
            showError(nameField, 'name-error', 'Enter a valid full name (letters & spaces only, min 3 chars)');
            valid = false;
          } else {
            hideError(nameField, 'name-error');
          }
        }


        if (emailField) {
          const emailVal = emailField.value.trim();
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(emailVal)) {
            showError(emailField, 'email-error', 'Enter a valid email address');
            valid = false;
          } else {

            const parts = emailVal.split('@');
            const local = parts[0] || '';
            const domain = (parts[1] || '').toLowerCase();

            if (domain === 'gmail.com') {

              const gmailLocalRegex = /^[A-Za-z][A-Za-z0-9._+]*$/;
              if (!gmailLocalRegex.test(local)) {
                showError(emailField, 'email-error', 'For gmail.com use format like "a123@gmail.com" or "abc.123+label@gmail.com"');
                valid = false;
              } else {
                hideError(emailField, 'email-error');
              }
            } else {
              hideError(emailField, 'email-error');
            }
          }
        }


        if (passwordField) {
          if (passwordField.value.length < 8) {
            showError(passwordField, 'password-error', 'Password must be at least 8 characters');
            valid = false;
          } else {
            hideError(passwordField, 'password-error');
          }
        }


        if (terms && !terms.checked) {

          terms.classList.add('animate-pulse', 'border-red-300');
          setTimeout(() => {
            terms.classList.remove('animate-pulse');
          }, 1000);

          valid = false;
        }

        if (!valid) {
          e.preventDefault();

          const firstError = document.querySelector('.text-xs.text-red-500:not(.hidden)');
          if (firstError) firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    })();
  </script>
  {% endblock %}